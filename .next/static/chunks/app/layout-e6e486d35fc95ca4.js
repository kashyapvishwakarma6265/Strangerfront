(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7634:function(e,o,r){Promise.resolve().then(r.t.bind(r,2445,23)),Promise.resolve().then(r.bind(r,2296))},4662:function(e,o,r){"use strict";let t;r.d(o,{H:function(){return m},a:function(){return h}});var a=r(7437),s=r(2265),n=r(3085),l=r(994),i=r(4086);console.log("\uD83D\uDD25 Initializing Firebase...");let u={apiKey:"AIzaSyBoP9F82lZNJ_bIkkAWAhJwuOgYlS4JaFg",authDomain:"stranger-chat-74b46.firebaseapp.com",projectId:"stranger-chat-74b46",storageBucket:"stranger-chat-74b46.appspot.com",messagingSenderId:"75423958257",appId:"1:75423958257:web:c1cd71cd1a3c9f7f69d550"};console.log("\uD83D\uDCDD Firebase Config:",{projectId:u.projectId||"❌ MISSING",authDomain:u.authDomain||"❌ MISSING",apiKey:u.apiKey?"✅ SET":"❌ MISSING"});try{t=(0,l.ZF)(u),console.log("✅ Firebase app initialized")}catch(e){console.error("❌ Firebase initialization error:",e)}let c=(0,n.v0)(t),d=(0,i.ad)(t);(0,n.Fb)(c,n.a$).then(()=>console.log("✅ Persistence enabled")).catch(e=>console.error("❌ Persistence error:",e));let g=async(e,o)=>{if(!e)return console.warn("⚠️ No userId provided to createUserProfile"),!1;try{let r=(0,i.JU)(d,"users",e);return await (0,i.pl)(r,{...o,updatedAt:(0,i.Bt)()},{merge:!0}),console.log("✅ Profile saved for user: ".concat(e)),!0}catch(e){return console.error("❌ Error creating user profile:",e),!1}},p=(0,s.createContext)(),h=()=>{let e=(0,s.useContext)(p);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},m=e=>{let{children:o}=e,[r,t]=(0,s.useState)(null),[l,i]=(0,s.useState)(!0),[u,d]=(0,s.useState)(null);(0,s.useEffect)(()=>{console.log("\uD83D\uDD0D Setting up auth state listener...");let e=!0,o=(0,n.Aj)(c,async o=>{console.log("\uD83D\uDC64 onAuthStateChanged fired:",(null==o?void 0:o.email)||"null");try{o?(console.log("✅ User found:",o.email),g(o.uid,{uid:o.uid,email:o.email,displayName:o.displayName||o.email.split("@")[0],photoURL:o.photoURL,lastActive:new Date,status:"online"}).catch(e=>console.error("Profile update error:",e)),e&&(console.log("✅ Setting user state:",o.email),t(o),d(null),i(!1))):(console.log("❌ No user found"),e&&(t(null),i(!1)))}catch(o){console.error("❌ Auth state error:",o),e&&(d(o.message),i(!1))}},o=>{console.error("❌ Auth listener error:",o),e&&(d(o.message),i(!1))});return()=>{console.log("\uD83E\uDDF9 Cleaning up auth listener"),e=!1,o()}},[]);let h=async function(e,o){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{i(!0),d(null),console.log("\uD83D\uDCDD Starting signup for:",e);let t=await (0,n.Xb)(c,e,o);return console.log("✅ User created in Firebase:",t.user.email),r&&(await (0,n.ck)(t.user,{displayName:r}),console.log("✅ Display name updated")),await g(t.user.uid,{uid:t.user.uid,email:t.user.email,displayName:r||e.split("@")[0],createdAt:new Date,lastActive:new Date,status:"online"}),console.log("✅ User profile created"),t}catch(e){throw console.error("❌ Signup error:",e),d("auth/email-already-in-use"===e.code?"This email is already registered":"auth/weak-password"===e.code?"Password should be at least 6 characters":e.message),i(!1),e}},m=async(e,o)=>{try{d(null),console.log("\uD83D\uDD10 Starting login for:",e);let r=await (0,n.e5)(c,e,o);return console.log("✅ User logged in:",r.user.email),g(r.user.uid,{lastActive:new Date,status:"online"}).catch(e=>console.error("Profile update error:",e)),r}catch(e){throw console.error("❌ Login error:",e),d("auth/invalid-credential"===e.code?"Invalid email or password":"auth/user-not-found"===e.code?"User not found":e.message),i(!1),e}},D=async()=>{try{d(null),i(!0);let e=new n.hJ;e.addScope("profile"),e.addScope("email"),e.setCustomParameters({prompt:"consent"}),console.log("\uD83D\uDD37 Starting Google login with popup...");let o=await (0,n.rh)(c,e);console.log("✅ Google login successful:",o.user.email),await g(o.user.uid,{uid:o.user.uid,email:o.user.email,displayName:o.user.displayName,photoURL:o.user.photoURL,provider:"google",lastActive:new Date,status:"online"}),console.log("✅ Google user profile created")}catch(e){console.error("❌ Google login error:",e.code,e.message),"auth/popup-blocked-by-browser"===e.code?d("❌ Google popup was blocked. Allow popups in browser settings."):"auth/popup-closed-by-user"===e.code?d("You closed the Google popup. Try again."):"auth/cancelled-popup-request"===e.code?d("Sign in was cancelled. Try again."):"auth/operation-not-supported-in-this-environment"===e.code?d("❌ Google sign in not available. Check Firebase config."):d(e.message||"Failed to sign in with Google"),i(!1)}},f=async e=>{try{return d(null),await (0,n.LS)(c,e),console.log("✅ Password reset email sent"),!0}catch(e){throw console.error("❌ Reset password error:",e),d("auth/user-not-found"===e.code?"No account found with this email":e.message),e}},w=async()=>{try{i(!0),d(null),console.log("\uD83D\uDEAA Logging out..."),r&&await g(r.uid,{status:"offline"}),await (0,n.w7)(c),i(!1),console.log("✅ Logout successful")}catch(e){console.error("❌ Logout error:",e),d(e.message),i(!1)}};return(0,a.jsx)(p.Provider,{value:{user:r,signup:h,login:m,googleLogin:D,resetPassword:f,logout:w,loading:l,error:u,setError:d},children:o})}},2296:function(e,o,r){"use strict";r.r(o),r.d(o,{Providers:function(){return s}});var t=r(7437),a=r(4662);function s(e){let{children:o}=e;return(0,t.jsx)(a.H,{children:o})}},2445:function(){}},function(e){e.O(0,[358,487,647,971,938,744],function(){return e(e.s=7634)}),_N_E=e.O()}]);